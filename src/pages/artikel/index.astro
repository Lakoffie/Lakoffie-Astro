---
import MainLayout from '../../layouts/MainLayout.astro';
import { daftarArtikel } from '../../data/artikel.ts';
import '../../styles/artikel.css';

const categories = ['Semua', 'Tips', 'Edukasi', 'Trending'];
---

<MainLayout title="Artikel Lakoffie | Inspirasi Kopi Murni">
  <div class="article-page-wrapper">
    
    <div class="container" style="padding: 60px 0 30px; text-align: center;">
      <span style="color: var(--gold); letter-spacing: 5px; font-size: 0.7rem; text-transform: uppercase;">The Coffee Journal</span>
      <h1 style="font-family: serif; font-size: 3rem; margin-top: 10px;">Inspirasi & <span style="color: var(--gold)">Edukasi</span></h1>
    </div>

    <section class="artikel-hero">
      <div class="slider-container">
        <div class="slider-track">
          {daftarArtikel.map((a) => (
            <div class="slide">
              <img src={a.image} alt={a.judul} />
              <div class="slide-overlay">
                <span class="tag">{a.kategori}</span>
                <h2>{a.judul}</h2>
                <a href={`/artikel/${a.slug}`} class="btn-read">Baca Selengkapnya</a>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <div class="container">
      <div class="blog-controls">
        <div class="tabs">
          {categories.map(cat => (
            <button class="tab-btn" data-category={cat}>{cat}</button>
          ))}
        </div>
        <input type="text" id="searchBlog" placeholder="Cari judul atau topik..." />
      </div>

      <div class="blog-grid" id="blogGrid">
        {daftarArtikel.map(a => (
          <article class="blog-card" data-category={a.kategori}>
            <div class="blog-img">
              <img src={a.image} alt={a.judul} loading="lazy" />
            </div>
            <div class="blog-content">
              <span class="blog-date">{a.tanggal} • {a.kategori}</span>
              <h3>{a.judul}</h3>
              <p>{a.excerpt}</p>
              <a href={`/artikel/${a.slug}`} class="read-link">Read Story →</a>
            </div>
          </article>
        ))}
      </div>
    </div>
  </div>
</MainLayout>

<script>
  const searchInput = document.getElementById('searchBlog') as HTMLInputElement;
  const cards = document.querySelectorAll('.blog-card') as NodeListOf<HTMLElement>;
  const tabBtns = document.querySelectorAll('.tab-btn');

  // Logic Live Search
  searchInput?.addEventListener('input', () => {
    const val = searchInput.value.toLowerCase();
    cards.forEach(card => {
      const title = card.querySelector('h3')?.innerText.toLowerCase() || '';
      card.style.display = title.includes(val) ? 'block' : 'none';
    });
  });

  // Logic Tab Filter
  tabBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const selectedCat = (btn as HTMLElement).dataset.category?.toLowerCase();
      
      // Update Active UI
      tabBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      cards.forEach(card => {
        const cardCat = card.dataset.category?.toLowerCase();
        if (selectedCat === 'semua' || cardCat === selectedCat) {
          card.style.display = 'block';
        } else {
          card.style.display = 'none';
        }
      });
    });
  });
</script>
